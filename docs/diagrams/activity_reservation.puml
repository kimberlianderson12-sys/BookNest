@startuml
title Диаграмма деятельности: Бронирование книги читателем

start
:Пользователь входит в систему;
:Переход на страницу "Книги";
:Поиск книги / Применение фильтров;
:Выбор книги из списка;
:Просмотр детальной информации о книге;

if (Есть доступные экземпляры?) then (да)
  :Выбор экземпляра;
  :Нажатие кнопки "Забронировать";
  
  if (Проверка лимита бронирований) then (превышен лимит)
    :Сообщение об ошибке;
    stop
  else (не превышен)
    if (Экземпляр доступен?) then (нет)
      :Сообщение об ошибке;
      stop
    else (да)
      :Создание записи в таблице reservations;
      :Обновление статуса экземпляра на 'reserved';
      :Расчет дат: pickup_deadline, due_date;
      :Сообщение об успешном бронировании;
    endif
  endif
else (нет)
  :Сообщение: "Нет доступных экземпляров";
  stop
endif

stop
@enduml

